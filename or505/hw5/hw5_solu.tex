\documentclass[12pt]{article}
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb,amsfonts}
\usepackage{enumitem}
\usepackage{placeins}
\usepackage{mathtools, eucal}
\usepackage{graphicx}
\usepackage{color}
 

 
\begin{document}
 
%\renewcommand{\qedsymbol}{\filledbox}
%Good resources for looking up how to do stuff:
%Binary operators: http://www.access2science.com/latex/Binary.html
%General help: http://en.wikibooks.org/wiki/LaTeX/Mathematics
%Or just google stuff
 
\title{Homework 5 Solutions}
\author{Zheming Gao}
\maketitle

\section*{Problem 1 (3.1)}

Suppose $A\in\mathbb R^{m\times n}, b\in\mathbb R^m$. Add slack variables$s_1, \dots, s_m \geqslant 0$ on each row and make it a standard form. 

Let starting feasible solution be $(x_1, \dots, x_n, s_1, \dots, x_m)^T = (0, \dots, 0, b_1, \dots, b_m)^T$.




\section*{Problem 2 (3.2)}
\begin{enumerate}
\item [(a)]

\begin{proof}

Let $d$ be a feasible direction at point $x\in P$. Then, there exists $\lambda> 0$ such that $x + \lambda d \in P$, which implies $A(x + \lambda d) = b$. Since $Ax = b$, we know that $\lambda Ad = 0$ and this implies $Ad = 0$.

\end{proof}


\item [(b)]

\begin{proof}

let $d = (d_1, \dots, d_n)^T$ be a feasible direction at $x$. Let $\alpha = \min\{\frac{x_i}{-d_i} | d_i < 0, i = 1, \dots, n \}$. If $d \geqslant 0$, then let $\alpha = 1$.

It is clear that $\alpha > 0$ and $x + \alpha d \geqslant 0$.

\end{proof}

\end{enumerate}


\section*{Problem 3 (3.3)}

$$
\begin{aligned}
\text{Minimize} \qquad & -2x_1 - x_2 + x_3 + x_4 + 2x_5 &  \\
\text{subject\  to} \qquad & -2x_1 + x_2 + x_3 + x_4 + x_5 & = 12\\
 & -x_1 + 2x_2 + x_4 - x_5 & = 5 \\
 & x_1 - 3x_2 + x_3 + 4x_5 & = 11 \\
 & x_1, x_2, x_3, x_4, x_5 & \geqslant 0
\end{aligned}
$$

Here, $A = \begin{pmatrix}
-2 & 1 & 1 & 1 & 1 \\
-1 & 2 & 0 & 1 & -1 \\
1 & -3 & 1 & 0 & 4 
\end{pmatrix}$ and $b = \begin{pmatrix}
12 \\ 
5 \\
11
\end{pmatrix}$

\begin{enumerate}[label = (\alph*)]
\item 

$B = [A_3, A_4, A_5] = \begin{pmatrix}
1 & 1 & 1\\
0 & 1 & -1 \\
1 & 0 & 4
\end{pmatrix}$, and $N = [A_1, A_2] = \begin{pmatrix}
-2 & 1 \\
-1 & 2 \\
1 & -3
\end{pmatrix}$.

The fundamental matrix $M = \begin{bmatrix}
B & N \\
\textbf{0} & I
\end{bmatrix} = \begin{bmatrix}
1 & 1 & 1 & -2 & 1 \\
0 & 1 & -1 & -1 & 2 \\
1 & 0 & 4 & 1 & -3 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{bmatrix}$ and $M^{-1} = \begin{bmatrix}
B^{-1} & -B^{-1} N \\
\textbf{0} & I
\end{bmatrix} = \begin{bmatrix}
2 & -2 & -1 & 3 & -1 \\
-1/2 & 3/2 & 1/2 & 0 & -1 \\
-1/2 & 1/2 & 1/2 & -1 & 1 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{bmatrix}$.

\item

%%Solved by matlab: rref([B, N])
Apply Gaussian elimination on matrix $[B, N]$ and get reduced row rechelon form
$$
\begin{bmatrix}
     1  &   0     &  0  &  -3  &   1 \\
     0  &   1 &    0  &   0  &   1 \\
     0  &   0 &    1  &   1  &  -1
     \end{bmatrix}
$$

Hence, $x_3 = 3x_1 - x_2 + 3, x_4 = -x_2 + 7, x_5 = -x_1 + x_2 + 2 $. Reform the LP problem using only two variables as the following:

$$
\begin{aligned}
\text{Minimize} \qquad & -x_1 - x_2 (+14) &  \\
\text{subject\  to} \qquad & 3x_1 - x_2 + 3 & \geqslant 0\\
 & -x_2 + 7 & \geqslant 0 \\
 & -x_1 + x_2 + 2 & \geqslant 0 \\
 & x_1, x_2 & \geqslant 0
\end{aligned}
$$

\item

The feasible domain is part of the intersection of three hyperplanes on $\mathbb R^5$, hence, its dimension is reduced by 3 and can be represented in $\mathbb R^2$.

We plot the region of $P$.

 \begin{figure}[htbp]
  \caption{Region $P$.}
  \centering
    \includegraphics[width=0.5\textwidth]{problem3.pdf}
    \label{problem3}
 \end{figure}

\FloatBarrier


\item

Basic feasible solution  $\textbf x = (0,0, 3,7,2)^T$. And it is corresponding to point $D = (0,0)^T$ on fig.\ref{problem3}.

\item

$$
B^{-1}A = \begin{bmatrix}
    -3 &    1 &    1 &    0 &    0 \\
     0  &   1  &   0   &  1   &  0 \\
     1   & -1  &   0  &   0  &   1
\end{bmatrix},  \qquad
B^{-1}b = \begin{bmatrix}
3 \\ 7 \\ 2
\end{bmatrix}
$$

One explaination of this:

We see that $B^{-1}A$ is the same with the reduced row echelon form of $A$. And $B^{-1}b$ is exactly the basic feasible solution (positive entries). This is always true since

$$
Ax = b \Leftrightarrow [B | N]\begin{bmatrix}
x_B \\ x_N
\end{bmatrix} = b.
$$

Since $x_N = 0$, we get $Bx_B = b$ so that $x_B = B^{-1}b$. This implies that $B^{-1}A$ is the reduced row echelon form of $A$ for basic variable, since $B^{-1}Ax = B^{-1}b = x_B$.

(Other proper answers will be also acceptable).

\item

From $M^{-1}$ we know that $\textbf d^1 = (3,0,-1,1,0)^T$ and $\textbf d^2 = (-1,-1,1,0,1)^T$. Reduced costs:

$$
r^1 = [c_B^T|c_N^T]\textbf d^1 = (1,1,2,-2,-1)\textbf d^1 = -1, \qquad r^2 = [c_B^T|c_N^T]\textbf d^2 = (1,1,2,-2,-1)\textbf d^2 = -1
$$

\item

From above, either direction leads to a potential reduction in the objective value, since $r^1$ and $r^2$ are both negative. Consider the nonnegativity constraint($x + \alpha \textbf d \geqslant 0$), we get the step length for $\textbf d^1$ is $\alpha_1 = 2$ and for $\textbf d^2$ is $\alpha_2 = 3$.

\item
\begin{enumerate}
\item[1)] If we take $\textbf d^1$, then the new solution will be $\overline{x} = x + \alpha_1 \textbf d^1 = (9,7,0,2,0)^T \geqslant 0$. The basis now is $\overline{B} = [A_3, A_4, A_1]$ and $\overline{N} = [A_5, A_2]$. It is easy to check that $\overline{B}\overline x = b$. Hence $\overline{x}$ is a basic feasible solution(BFS). $\overline{x}$ is also an adjacent extreme point of $x$. (On fig.\ref{problem3}, $\overline{x}$ is the point $C$)

\item[2)] If we take $\textbf d^2$, then the new solution will be $\overline{x} = x + \alpha_2 \textbf d^2 = (0,4,5,0,3)^T \geqslant 0$. The basis now is $\overline{B} = [A_4, A_5, A_2]$ and $\overline{N} = [A_3, A_1]$. It is easy to check that $\overline{B}\overline x = b$. Hence $\overline{x}$ is a basic feasible solution(BFS). $\overline{x}$ is also an adjacent extreme point of $x$. (On fig.\ref{problem3}, $\overline{x}$ is the point $E$)

\end{enumerate}

\item

\begin{enumerate}
\item[1)] If we take $\textbf d^1$, update $\tilde{M} = \begin{bmatrix}
\tilde B & \tilde N \\
\textbf 0 & I
\end{bmatrix}$.

$$
\tilde M = \begin{bmatrix}
     1   &  1  &  -2  &   1  &   1\\
     0  &   1   & -1  &  -1  &   2\\
     1   &  0  &   1   &  4  &  -3\\
     0   &  0  &   0   &  1   &  0\\
     0   &  0   &  0  &   0   &  1
\end{bmatrix}, \qquad 
\tilde M^{-1} = \begin{bmatrix}
     1/2   &  -1/2  &  1/2  &   -3  &  2\\
     -1/2  &   3/2   & 1/2  &  0  &   -1 \\
     -1/2   &  1/2  &   1/2   &  -1  &  1 \\
     0   &  0  &   0   &  1   &  0\\
     0   &  0   &  0  &   0   &  1
\end{bmatrix}
$$

From the last two columns of $\tilde M^{-1}$ we get $\tilde {\textbf{d}}^5 = \begin{bmatrix}
-3 \\ 0 \\ -1 \\ 1 \\ 0
\end{bmatrix}$, $\tilde {\textbf{d}}^2 = \begin{bmatrix}
2 \\ -1 \\ 1 \\ 0 \\ 1
\end{bmatrix}$.

Let $\tilde c^T = [\tilde c_B^T | \tilde c_N^T]$. We get $\tilde c^T\tilde{\textbf d}^5 = 1 > 0$, but $\tilde c^T\tilde{\textbf d}^2 = -2 < 0$. So $\tilde x$ is not an optimal solution since $\tilde{\textbf d}^2$ is a good direction of translation.



\item[2)] If we take $\textbf d^2$, update $\overline{M} = \begin{bmatrix}
\overline B & \overline N \\
\textbf 0 & I
\end{bmatrix}$.

$$
\overline M = \begin{bmatrix}
     1  &   1  &   1  &   1   & -2\\
     1  &  -1  &   2  &   0  &  -1\\
     0   &  4  &  -3  &   1  &   1\\
     0  &   0  &   0  &   1  &   0\\
     0   &  0  &   0  &   0  &   1
\end{bmatrix}, \qquad 
\overline M^{-1} = \begin{bmatrix}
     -5/2   &  7/2  &  3/2  &   1  &  -3\\
     3/2  &   -3/2   & -1/2  &  -1  &   2 \\
     2   &  -2  &   -1  &  -1  &  3 \\
     0   &  0  &   0   &  1   &  0\\
     0   &  0   &  0  &   0   &  1
\end{bmatrix}
$$

From the last two columns of $\overline M^{-1}$ we get $\overline {\textbf{d}}^5 = \begin{bmatrix}
1 \\ -1 \\ -1 \\ 1 \\ 0
\end{bmatrix}$, $\overline {\textbf{d}}^2 = \begin{bmatrix}
-3 \\ 2 \\ 3 \\ 0 \\ 1
\end{bmatrix}$.

Let $\overline c^T = [\overline c_B^T | \overline c_N^T]$. We get $\overline c^T\overline{\textbf d}^3 = 1 > 0$, but $\overline c^T\overline{\textbf d}^1 = -4 < 0$. So $\overline x$ is not an optimal solution since $ \overline {\textbf d}^1$ is a good direction of translation.
\end{enumerate}

\item 
\begin{enumerate}
\item [1)]
If basic varialbes are $x_3, x_4, x_1$, then the reduced row echelon form (RREF) of $[\tilde{B}, \tilde N, -b]$ is

$$
\begin{bmatrix}
     1  &   0   &  0  &   3 &   -2  &  -9\\
     0  &   1  &   0  &   0 &    1  &  -7\\
     0  &   0   &  1  &   1 &   -1  &  -2
\end{bmatrix}
$$

and $x_3 = 2x_2 - 3x_5 + 9, x_4 = -x_2 + 7, x_1 = x_2 - x_5 + 2 $. Reform the LP problem using only two variables as the following:

$$
\begin{aligned}
\text{Minimize} \qquad & -2x_2 + x_5 (+12) &  \\
\text{subject\  to} \qquad & 2x_2 - 3x_5 + 9 & \geqslant 0\\
 & -x_2 + 7 & \geqslant 0 \\
 & x_2 - x_5 + 2 & \geqslant 0 \\
 & x_2, x_5 & \geqslant 0
\end{aligned}
$$

We plot the region.

 \begin{figure}[htbp]
  \caption{Region on $x_2, x_5$.}
  \centering
    \includegraphics[width=0.5\textwidth]{problem3_j1.pdf}
    \label{problem3j1}
 \end{figure}

\FloatBarrier



\item [2)]

If basic varialbes are $x_4, x_5, x_2$, then the reduced row echelon form (RREF) of $[\overline{B}, \overline N, -b]$ is

$$
\begin{bmatrix}
     1  &   0  &   0  &  -1  &   3  &  -4 \\
     0  &   1  &   0   &  1  &  -2 &   -5\\
     0  &   0  &   1   &  1  &  -3  &  -3
\end{bmatrix}
$$

and $x_4 = x_3 - 3x_1 + 4, x_5 = -x_3 + 2x_1 + 5, x_2 = -x_3 + 3x_1 + 3 $. Reform the LP problem using only two variables as the following:

$$
\begin{aligned}
\text{Minimize} \qquad & -4x_1 + x_3 (+11) &  \\
\text{subject\  to} \qquad & x_3 - 3x_1 + 4 & \geqslant 0\\
 & -x_3 + 2x_1 + 5 & \geqslant 0 \\
 & -x_3 + 3x_1 + 3 & \geqslant 0 \\
 & x_1, x_3 & \geqslant 0
\end{aligned}
$$

We plot the region.

 \begin{figure}[htbp]
  \caption{Region on $x_1, x_3$.}
  \centering
    \includegraphics[width=0.5\textwidth]{problem3_j2.pdf}
    \label{problem3j2}
 \end{figure}

\FloatBarrier

\end{enumerate}

\item

(Any proper answer will be acceptable).

\item

We can always express $n-2$ variables by using the rest $2$ variables. Then, the LP problem can be reformed as an LP problem on $\mathbb R^2$.



\end{enumerate}



\section*{Problem 4 (3.4)}

From point $x = [x_B | x_N]^T = [x_5, x_6, x_1| x_2, x_3, x_4]^T$, we know that $B = [A_5, A_6, A_1]$ and $N = [A_2, A_3, A_4]$. Construct matrix $M = \begin{bmatrix}
B & N \\
\textbf 0 & I
\end{bmatrix}$ and reduced cost $r = c_N^T - c_B^TB^{-1}N = [-1, -1, 1/2]$.

Note that $r_2, r_3$ are negative, and figure out the step length $\alpha_2 = \alpha_3 = 1/2$. Hence, we can pick either one from $\textbf d^2$ or $\textbf{d}^3$. Let's pick $\textbf d^2$. $x_{\text{new}} = x + \alpha_2\textbf{d}^2 = (0,1,1/2,1/2,0,0)^T$. 

Next step:

From point $x = [x_2, x_6, x_1 | x_5, x_3, x_4] = (1/2,1,1/2,0,0,0)^T$, we know $B = [A_2, A_6, A_1]$ and $N = [A_5, A_3, A_4]$. Construct matrix $M$ and reduced cost $r = c_N^T - c_B^TB^{-1}N = [-1/2, -1, -1/2]$. Find the most negative direction, pick $\textbf d^3$ with $\alpha_3 = 1/2$. $x_{\text{new}} = x + \alpha_3\textbf{d}^3 =  (1/2,0,1/2,1/2,0,0)^T$.

Next step:

From point $x = [x_1, x_2, x_3 | x_4, x_5, x_6] = (1/2,1,1/2,0,0,0)^T$, we know $B = [A_1, A_2, A_3]$ and $N = [A_4, A_5, A_6]$. Compute the reduced cost $r = c_N^T - c_B^TB^{-1}N = [1/2, 1/2, 1/2]  \geqslant 0$. Hence, $x = [x_1, x_2, x_3 | x_4, x_5, x_6] = (1/2,1,1/2,0,0,0)^T$ is the optimal solution.



\section*{Problem 5 (3.8)}













\vspace{50mm}
\begin{enumerate}
\item [(1)]
We plot the graph of $F_3$.


\item [(2)]
$$
B = \{(x_1, x_2, x_3)^T \in \mathbb R^3 | |x_1| + |x_3| = x_2 \}.
$$



\item [(3)]

$$
I = \{(x_1, x_2, x_3)^T \in \mathbb R^3 | |x_1| + |x_3| < x_2 \}.
$$


\item [(4)]

Extreme point: $(0, 0, 0)^T$.

Vertex: $(0, 0, 0)^T$.

\item [(5)]
\begin{proof}

First, we show that $F_3$ is a cone. Take $x = (x_1, x_2, x_3)^T \in F_3$ and $\forall \lambda \geqslant 0$, check if $\lambda x \in F_3$. 

$$
|\lambda x_1| + |\lambda x_3| = \lambda |x_1| + \lambda |x_3| = \lambda (|x_1| + |x_3|) \leqslant \lambda x_2.
$$

Hence, $\lambda x$ is in $F_3$. In conclusion, $F_3$ is a cone.

Next, we need to show $F_3$ is convex. Take $x, y \in F_3$ and $\forall \eta \in (0, 1)$, $\eta x + (1- \eta) y = (\eta x_1 + (1-\eta)y_1, \eta x_2 + (1-\eta)y_2, \eta x_3 + (1-\eta)y_3)$. Use triangle inequality of absolute value and we get

$$
\begin{aligned}
|\eta x_1 + (1-\eta)y_1| + |\eta x_3 + (1-\eta)y_3| & \leqslant \eta |x_1| + (1-\eta)|y_1| + \eta |x_3| + (1-\eta)|y_3| \\
& = \eta (|x_1|+|x_3|) + (1-\eta)(|y_1|+|y_3|) \\
& \leqslant \eta x_2 + (1-\eta) y_2.
\end{aligned}
$$

Hence, $\eta x + (1- \eta) y \in F_3$. This implies that $F_3$ is convex.

\end{proof}

\item [(6)]

(Any reasonable answers will be fine for this question.)

\textbf{Example answer:}

$\mathbb R_+^3$ are different from $F_3$ and $\mathbb R_+^3 \cap F_3 \neq \phi$. 

$(-1, 2, -1)^T \notin \mathbb R_+^3$ but in $F_3$. $(2,1,2)^T \notin F_3$, but in $\mathbb R_+^3$.

\end{enumerate}








\section*{Problem 6}
We plot the region of $P_1$.


\begin{enumerate}
\item [(a)]
Convert $P_1$ to standard equality form.
$$
\left\{
\begin{aligned}
& 2x_1 - 4x_2 + a_1 & & = 1 \\
& 3x_1 - x_2   & -a_2 & = -3 \\
& x_1, x_2, a_1, a_2 & & \geqslant 0.
\end{aligned}
\right.
$$

\item[(b)]
Basic solutions (in the form of $(x_1, x_2, a_1, a_2)$): 
$$
\begin{aligned}
&(-13/10, -9/10, 0, 0)   \\ 
&(-1, 0, 3, 0)\\ 
&(1/2, 0, 0, 9/2) \star\\
& (0, 3, 13, 0)\star\\ 
 &(0, -1/4, 0, 13/4)\\
 & (0, 0, 1, 3)\star
\end{aligned}
$$

\item[(c)]
Basic feasible solutions are those basic solutions with "$\star$".

\item[(d)]
Let $V$ be the set of all extremal directions. 
$$
V = \{v \in\mathbb R^2| v = (1, d)^T, d\in [1/2, 3] \}.
$$

\item[(e)]
From the figure, we can see that there are two moving directions to the adjacent points. $u_1$ is to point $(1/2, 0)^T$ and $u_2$ is to point $(0, 3)^T$.

$$
\begin{aligned}
&u_1 = (1, 0)^T \\
&u_2 = (0, 1)^T 
\end{aligned}
$$
\end{enumerate}

\section*{Problem 7}

We plot the region of $P_2$.
%
% \begin{figure}[htbp]
%  \caption{Region $P_2$.}
%  \centering
%    \includegraphics[width=0.5\textwidth]{p7.pdf}
% \end{figure}

\FloatBarrier

\begin{enumerate}
\item [(a)]
Convert $P_2$ to standard equality form.
$$
\left\{
\begin{aligned}
& 2x_1 - 2x_2^+ + 2x_2^- + a_1 & & = 3 \\
& 8x_1 - x_2^+ + x_2^-   & -a_2 & = -4 \\
& x_1, x_2^+, x_2^-, a_1, a_2 & & \geqslant 0.
\end{aligned}
\right.
$$

\item[(b)]
Basic solutions (in the form of $(x_1, x_2^+, x_2^-, a_1, a_2)$): 
$$
\begin{aligned}
&(-1/2, -1, 0, 0, 0)   \\ 
&(-1/2, 1, 0, 0, 0) \\ 
&(-1/2, 0, 0, 4, 0) \\
& (3/2, 0, 0, 0, 16) \star \\ 
 &(0, 4, 0, 11, 0) \star \\
 & (0, -3/2, 0, 0, 11/2) \\
 & (0, 0, -4, 11, 0) \\
& (0, 0, 3/2, 0, 11/2) \star \\
& (0, 0, 0, 3, 4) \star
\end{aligned}
$$

\item[(c)]
Basic feasible solutions are those basic solutions with "$\star$".

\item[(d)]
Let $V$ be the set of all extremal directions. 
$$
V = \{v \in\mathbb R^2| v = (1, d)^T, d\in [1, 8] \}.
$$

\item[(e)]
From the figure, we can see that there is only one moving directions to the adjacent point $(0, -3/2)^T$. 

$$
u = (0, -1)^T
$$
\end{enumerate}

\end{document}